/*
 * VPDB - Virtual Pinball Database
 * Copyright (C) 2019 freezy <freezy@vpdb.io>
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
 */

import { GLTF } from 'three/examples/jsm/loaders/GLTFLoader';
import { Mesh } from 'three/src/objects/Mesh';
import { ThreeHelper } from '../../../test/three.helper';
import { NodeBinaryReader } from '../../io/binary-reader.node';
import { Table } from '../table/table';
import { TableExporter } from '../table/table-exporter';

const three = new ThreeHelper();

describe('The VPinball spinner generator', () => {

	let gltf: GLTF;

	before(async () => {
		const table = await Table.load(new NodeBinaryReader(three.fixturePath('table-spinner.vpx')));
		const exporter = new TableExporter(table);
		gltf = await three.loadGlb(await exporter.exportGlb());
	});

	it('should generate a standard spinner mesh', async () => {
		const plateMesh = three.find<Mesh>(gltf, 'spinners', 'Spinner', 'spinnerplate-Spinner');
		const plateMeshVertices = three.vertices(plateMesh);
		let expectedVertices = [
			[228.001434, 1171.200928, -77.000641],
			[228.001434, 1166.799072, -77.000641],
			[228.002243, 1166.799072, -42.999199],
			[228.002243, 1171.200928, -42.999199],
			[169.997757, 1166.799072, -77.000801],
			[169.997757, 1171.200928, -77.000801],
			[169.997833, 1171.200928, -42.999119],
			[169.997833, 1166.799072, -42.999119],
			[222.502243, 1166.799072, -37.499199],
			[175.497833, 1166.799072, -37.499123],
			[222.502243, 1171.200928, -37.499199],
			[175.497833, 1171.200928, -37.499123],
			[222.501434, 1166.799072, -82.500641],
			[175.497757, 1171.200928, -82.500801],
			[175.497757, 1166.799072, -82.500801],
			[222.501434, 1171.200928, -82.500641],
			[224.604721, 1171.200928, -82.081436],
			[224.604721, 1166.799072, -82.081436],
			[226.389038, 1171.200928, -80.889206],
			[226.389038, 1166.799072, -80.889206],
			[227.581284, 1171.200928, -79.104797],
			[227.581360, 1166.799072, -79.104797],
			[173.395203, 1171.200928, -82.081284],
			[173.395203, 1166.799072, -82.081284],
			[171.610870, 1171.200928, -80.889038],
			[171.610870, 1166.799072, -80.889038],
			[170.418640, 1171.200928, -79.104721],
			[170.418640, 1166.799072, -79.104721],
			[224.604797, 1171.200928, -37.918720],
			[224.604797, 1166.799072, -37.918720],
			[226.389130, 1171.200928, -39.110962],
			[226.389130, 1166.799072, -39.110962],
			[227.581360, 1171.200928, -40.895279],
			[227.581360, 1166.799072, -40.895279],
			[173.395279, 1171.200928, -37.918560],
			[175.497833, 1171.200928, -37.499123],
			[173.395279, 1166.799072, -37.918560],
			[175.497833, 1166.799072, -37.499123],
			[171.610962, 1171.200928, -39.110878],
			[171.610962, 1166.799072, -39.110878],
			[170.418640, 1171.200928, -40.895199],
			[170.418716, 1166.799072, -40.895199],
			[224.604721, 1171.200928, -82.081436],
			[199.000000, 1171.200928, -60.000000],
			[222.501434, 1171.200928, -82.500641],
			[226.389038, 1171.200928, -80.889206],
			[227.581284, 1171.200928, -79.104797],
			[228.001434, 1171.200928, -77.000641],
			[175.497757, 1171.200928, -82.500801],
			[173.395203, 1171.200928, -82.081284],
			[171.610870, 1171.200928, -80.889038],
			[170.418640, 1171.200928, -79.104721],
			[169.997757, 1171.200928, -77.000801],
			[169.997833, 1171.200928, -42.999119],
			[170.418640, 1171.200928, -40.895199],
			[171.610962, 1171.200928, -39.110878],
			[173.395279, 1171.200928, -37.918560],
			[175.497833, 1171.200928, -37.499123],
			[222.502243, 1171.200928, -37.499199],
			[224.604797, 1171.200928, -37.918720],
			[226.389130, 1171.200928, -39.110962],
			[227.581360, 1171.200928, -40.895279],
			[228.002243, 1171.200928, -42.999199],
			[222.501434, 1166.799072, -82.500641],
			[199.000000, 1166.799072, -60.000000],
			[224.604721, 1166.799072, -82.081436],
			[226.389038, 1166.799072, -80.889206],
			[227.581360, 1166.799072, -79.104797],
			[228.001434, 1166.799072, -77.000641],
			[175.497757, 1166.799072, -82.500801],
			[173.395203, 1166.799072, -82.081284],
			[171.610870, 1166.799072, -80.889038],
			[170.418640, 1166.799072, -79.104721],
			[169.997757, 1166.799072, -77.000801],
			[169.997833, 1166.799072, -42.999119],
			[170.418716, 1166.799072, -40.895199],
			[171.610962, 1166.799072, -39.110878],
			[173.395279, 1166.799072, -37.918560],
			[175.497833, 1166.799072, -37.499123],
			[222.502243, 1166.799072, -37.499199],
			[224.604797, 1166.799072, -37.918720],
			[226.389130, 1166.799072, -39.110962],
			[227.581360, 1166.799072, -40.895279],
			[228.002243, 1166.799072, -42.999199],
			[237.000000, 1169.712524, -54.712559],
			[161.000000, 1168.999878, -55.007519],
			[237.000000, 1169.000122, -55.007679],
			[161.000000, 1169.712402, -54.712399],
			[161.000000, 1170.007568, -53.999920],
			[237.000000, 1170.007690, -54.000080],
			[237.000000, 1169.712524, -53.287601],
			[161.000000, 1169.712402, -53.287441],
			[161.000000, 1168.999878, -52.992321],
			[237.000000, 1169.000122, -52.992481],
			[237.000000, 1168.287598, -53.287601],
			[161.000000, 1168.999878, -52.992321],
			[237.000000, 1169.000122, -52.992481],
			[161.000000, 1168.287476, -53.287441],
			[161.000000, 1167.992310, -53.999920],
			[237.000000, 1167.992432, -54.000080],
			[237.000000, 1168.287598, -54.712559],
			[161.000000, 1168.287476, -54.712399],
			[160.212479, 1168.999878, -55.212399],
			[160.003845, 1169.712402, -55.003761],
			[159.500000, 1170.007568, -54.499920],
			[158.996155, 1169.712402, -53.996078],
			[158.787521, 1168.999878, -53.787441],
			[158.787521, 1168.999878, -53.787441],
			[158.996155, 1168.287476, -53.996078],
			[159.500000, 1167.992310, -54.499920],
			[160.003845, 1168.287476, -55.003761],
			[160.007690, 1168.999878, -55.999920],
			[159.712479, 1169.712402, -55.999920],
			[159.000000, 1170.007568, -55.999920],
			[158.287521, 1169.712402, -55.999920],
			[157.992401, 1168.999878, -55.999920],
			[157.992401, 1168.999878, -55.999920],
			[158.287521, 1168.287476, -55.999920],
			[159.000000, 1167.992310, -55.999920],
			[159.712479, 1168.287476, -55.999920],
			[237.996155, 1169.712524, -55.003922],
			[237.787521, 1169.000122, -55.212559],
			[238.500000, 1170.007690, -54.500080],
			[239.003845, 1169.712524, -53.996239],
			[239.212555, 1169.000122, -53.787598],
			[239.003845, 1168.287598, -53.996239],
			[239.212555, 1169.000122, -53.787598],
			[238.500000, 1167.992432, -54.500080],
			[237.996155, 1168.287598, -55.003922],
			[238.287521, 1169.712524, -56.000080],
			[237.992401, 1169.000122, -56.000080],
			[239.000000, 1170.007690, -56.000080],
			[239.712479, 1169.712524, -56.000080],
			[240.007690, 1169.000122, -56.000080],
			[239.712479, 1168.287598, -56.000080],
			[240.007690, 1169.000122, -56.000080],
			[239.000000, 1167.992432, -56.000080],
			[238.287521, 1168.287598, -56.000080],
			[160.007599, 1168.999878, -57.999920],
			[159.712479, 1169.712402, -57.999920],
			[159.000000, 1170.007568, -57.999920],
			[158.287521, 1169.712402, -57.999920],
			[157.992401, 1168.999878, -57.999920],
			[157.992401, 1168.999878, -57.999920],
			[158.287521, 1168.287476, -57.999920],
			[159.000000, 1167.992310, -57.999920],
			[159.712479, 1168.287476, -57.999920],
			[238.287521, 1169.712524, -58.000080],
			[237.992401, 1169.000122, -58.000080],
			[239.000000, 1170.007690, -58.000080],
			[239.712479, 1169.712524, -58.000080],
			[240.007599, 1169.000122, -58.000080],
			[239.712479, 1168.287598, -58.000080],
			[240.007599, 1169.000122, -58.000080],
			[239.000000, 1167.992432, -58.000080],
			[238.287521, 1168.287598, -58.000080],
			[159.212479, 1168.999878, -60.212399],
			[159.003845, 1169.712402, -60.003761],
			[158.500000, 1170.007568, -59.499920],
			[157.996155, 1169.712402, -58.996078],
			[157.787521, 1168.999878, -58.787441],
			[157.787521, 1168.999878, -58.787441],
			[157.996155, 1168.287476, -58.996078],
			[158.500000, 1167.992310, -59.499920],
			[159.003845, 1168.287476, -60.003761],
			[157.000000, 1168.999878, -61.007519],
			[157.000000, 1169.712402, -60.712399],
			[157.000000, 1170.007568, -59.999920],
			[157.000000, 1169.712402, -59.287441],
			[157.000000, 1168.999878, -58.992321],
			[157.000000, 1168.999878, -58.992321],
			[157.000000, 1168.287476, -59.287441],
			[157.000000, 1167.992310, -59.999920],
			[157.000000, 1168.287476, -60.712399],
			[238.996155, 1169.712524, -60.003922],
			[238.787521, 1169.000122, -60.212559],
			[239.500000, 1170.007690, -59.500080],
			[240.003845, 1169.712524, -58.996239],
			[240.212479, 1169.000122, -58.787601],
			[240.003845, 1168.287598, -58.996239],
			[240.212479, 1169.000122, -58.787601],
			[239.500000, 1167.992432, -59.500080],
			[238.996155, 1168.287598, -60.003922],
			[241.000000, 1169.712524, -60.712559],
			[241.000000, 1169.000122, -61.007679],
			[241.000000, 1170.007690, -60.000080],
			[241.000000, 1169.712524, -59.287601],
			[241.000000, 1169.000122, -58.992481],
			[241.000000, 1168.287598, -59.287601],
			[241.000000, 1169.000122, -58.992481],
			[241.000000, 1167.992432, -60.000080],
			[241.000000, 1168.287598, -60.712559],
			[254.878632, 1169.712646, -60.712639],
			[254.878632, 1169.000122, -61.007759],
			[254.878632, 1170.007813, -60.000080],
			[254.878632, 1169.712646, -59.287601],
			[254.878632, 1169.000122, -58.992481],
			[254.878632, 1168.287598, -59.287601],
			[254.878632, 1169.000122, -58.992481],
			[254.878632, 1167.992432, -60.000080],
			[254.878632, 1168.287598, -60.712639],
			[142.965210, 1168.999878, -61.007519],
			[142.965210, 1169.712402, -60.712399],
			[142.965210, 1170.007568, -59.999920],
			[142.965210, 1169.712402, -59.287361],
			[142.965210, 1168.999878, -58.992241],
			[142.965210, 1168.999878, -58.992241],
			[142.965210, 1168.287354, -59.287361],
			[142.965210, 1167.992188, -59.999920],
			[142.965210, 1168.287354, -60.712399],
			[142.965210, 1168.999878, -59.999920],
			[142.965210, 1168.999878, -61.007519],
			[142.965210, 1169.712402, -60.712399],
			[142.965210, 1170.007568, -59.999920],
			[142.965210, 1169.712402, -59.287361],
			[142.965210, 1168.999878, -58.992241],
			[142.965210, 1168.287354, -59.287361],
			[142.965210, 1167.992188, -59.999920],
			[142.965210, 1168.287354, -60.712399],
			[254.878632, 1169.000122, -60.000080],
			[254.878632, 1169.712646, -60.712639],
			[254.878632, 1169.000122, -61.007759],
			[254.878632, 1170.007813, -60.000080],
			[254.878632, 1169.712646, -59.287601],
			[254.878632, 1169.000122, -58.992481],
			[254.878632, 1168.287598, -59.287601],
			[254.878632, 1167.992432, -60.000080],
			[254.878632, 1168.287598, -60.712639],
		];
		three.expectVerticesInArray(expectedVertices, plateMeshVertices);

		const bracketMesh = three.find<Mesh>(gltf, 'spinners', 'Spinner', 'spinnerbracket-Spinner');
		const bracketMeshVertices = three.vertices(bracketMesh);
		expectedVertices = [
			[239.796234, 1169.677368, -98.095039],
			[158.203766, 1169.677246, -98.094955],
			[239.796234, 1168.322754, -98.095039],
			[158.203766, 1168.322632, -98.094955],
			[158.203766, 1169.677246, -98.094955],
			[154.523758, 1171.678101, -97.832397],
			[154.523758, 1166.321899, -97.832397],
			[158.203766, 1168.322632, -98.094955],
			[243.476242, 1171.678101, -97.832481],
			[154.523758, 1171.678101, -97.832397],
			[239.796234, 1169.677368, -98.095039],
			[158.203766, 1169.677246, -98.094955],
			[243.476242, 1166.321899, -97.832481],
			[239.796234, 1168.322754, -98.095039],
			[158.203766, 1168.322632, -98.094955],
			[154.523758, 1166.321899, -97.832397],
			[150.843750, 1176.680054, -97.401443],
			[150.843750, 1161.319946, -97.401443],
			[247.156250, 1176.680054, -97.401443],
			[150.843750, 1176.680054, -97.401443],
			[247.156250, 1161.319946, -97.401443],
			[150.843750, 1161.319946, -97.401443],
			[148.973755, 1161.319946, -97.401443],
			[148.973755, 1176.680054, -97.401443],
			[150.843750, 1161.319946, -97.401443],
			[148.973755, 1161.319946, -97.401443],
			[149.923767, 1161.319946, -95.423599],
			[149.923767, 1176.680054, -95.423599],
			[148.973755, 1176.680054, -97.401443],
			[150.843750, 1176.680054, -97.401443],
			[248.076233, 1161.319946, -95.423676],
			[247.156250, 1161.319946, -97.401443],
			[248.076233, 1176.680054, -95.423676],
			[247.156250, 1176.680054, -97.401443],
			[149.923767, 1176.680054, -95.423599],
			[248.076233, 1176.680054, -95.423676],
			[248.076233, 1161.319946, -95.423676],
			[149.923767, 1161.319946, -95.423599],
			[147.143997, 1161.319946, -95.423599],
			[147.143997, 1176.680054, -95.423599],
			[148.973755, 1161.319946, -94.468079],
			[147.143997, 1161.319946, -95.423599],
			[147.143997, 1176.680054, -95.423599],
			[148.973755, 1176.680054, -94.468079],
			[148.973755, 1176.680054, -94.468079],
			[148.973755, 1161.319946, -94.468079],
			[147.143997, 1161.319946, -57.320801],
			[147.143997, 1176.680054, -57.320801],
			[148.973755, 1161.319946, -56.365120],
			[147.143997, 1161.319946, -57.320801],
			[147.143997, 1176.680054, -57.320801],
			[148.973755, 1176.680054, -56.365120],
			[148.973755, 1176.680054, -56.365120],
			[148.973755, 1161.319946, -56.365120],
			[147.143997, 1161.319946, -54.387280],
			[147.143997, 1176.680054, -54.387280],
			[146.158646, 1161.319946, -56.365120],
			[147.143997, 1161.319946, -54.387280],
			[147.143997, 1176.680054, -54.387280],
			[146.158646, 1176.680054, -56.365120],
			[146.158646, 1176.680054, -56.365120],
			[146.158646, 1161.319946, -56.365120],
			[123.750076, 1176.679932, -54.387280],
			[122.646080, 1174.509888, -54.387280],
			[121.634079, 1168.999878, -54.387280],
			[123.750076, 1161.319946, -54.387280],
			[123.750076, 1161.319946, -56.365120],
			[123.750076, 1176.679932, -56.365120],
			[123.750076, 1176.679932, -54.387280],
			[123.750076, 1161.319946, -56.365120],
			[122.646080, 1163.490112, -56.365120],
			[121.634079, 1168.999878, -56.365120],
			[243.476242, 1166.321899, -97.832481],
			[243.476242, 1171.678101, -97.832481],
			[239.796234, 1169.677368, -98.095039],
			[239.796234, 1168.322754, -98.095039],
			[247.156250, 1161.319946, -97.401443],
			[247.156250, 1176.680054, -97.401443],
			[121.910080, 1171.839600, -56.365120],
			[121.910080, 1166.160278, -54.387280],
			[122.646080, 1163.490112, -56.365120],
			[121.910080, 1166.160278, -56.365120],
			[122.646080, 1163.490112, -54.387280],
			[121.634079, 1168.999878, -56.365120],
			[121.910080, 1166.160278, -54.387280],
			[122.646080, 1174.509888, -56.365120],
			[121.634079, 1168.999878, -54.387280],
			[121.910080, 1171.839600, -54.387280],
			[122.646080, 1174.509888, -56.365120],
			[121.910080, 1171.839600, -56.365120],
			[121.910080, 1171.839600, -54.387280],
			[122.646080, 1174.509888, -54.387280],
			[121.910080, 1166.160278, -56.365120],
			[122.646080, 1163.490112, -54.387280],
			[123.750076, 1161.319946, -54.387280],
			[123.750076, 1176.679932, -56.365120],
			[249.026245, 1161.319946, -97.401443],
			[249.026245, 1176.680054, -97.401443],
			[249.026245, 1161.319946, -97.401443],
			[249.026245, 1176.680054, -97.401443],
			[250.856003, 1161.319946, -95.423676],
			[250.856003, 1176.680054, -95.423676],
			[250.856003, 1161.319946, -95.423676],
			[249.026245, 1161.319946, -94.468155],
			[250.856003, 1176.680054, -95.423676],
			[249.026245, 1176.680054, -94.468155],
			[249.026245, 1161.319946, -94.468155],
			[249.026245, 1176.680054, -94.468155],
			[250.856003, 1161.319946, -57.320801],
			[250.856003, 1176.680054, -57.320801],
			[250.856003, 1161.319946, -57.320801],
			[249.026245, 1161.319946, -56.365200],
			[250.856003, 1176.680054, -57.320801],
			[249.026245, 1176.680054, -56.365200],
			[249.026245, 1176.680054, -56.365200],
			[249.026245, 1161.319946, -56.365200],
			[250.856003, 1161.319946, -54.387360],
			[250.856003, 1176.680054, -54.387360],
			[251.841354, 1161.319946, -56.365200],
			[250.856003, 1161.319946, -54.387360],
			[251.841354, 1176.680054, -56.365200],
			[250.856003, 1176.680054, -54.387360],
			[251.841354, 1161.319946, -56.365200],
			[251.841354, 1176.680054, -56.365200],
			[275.353912, 1174.509888, -54.387360],
			[274.249939, 1176.680054, -54.387360],
			[276.365906, 1169.000122, -54.387360],
			[274.249939, 1161.320068, -54.387360],
			[274.249939, 1161.320068, -56.365200],
			[274.249939, 1176.680054, -54.387360],
			[274.249939, 1176.680054, -56.365200],
			[275.353912, 1163.490112, -56.365200],
			[274.249939, 1161.320068, -56.365200],
			[276.365906, 1169.000122, -56.365200],
			[276.089905, 1171.839722, -56.365200],
			[276.089905, 1166.160400, -54.387360],
			[275.353912, 1163.490112, -54.387360],
			[276.089905, 1166.160400, -56.365200],
			[275.353912, 1163.490112, -56.365200],
			[276.089905, 1166.160400, -54.387360],
			[276.365906, 1169.000122, -56.365200],
			[275.353912, 1174.509888, -56.365200],
			[276.089905, 1171.839722, -54.387360],
			[276.365906, 1169.000122, -54.387360],
			[275.353912, 1174.509888, -56.365200],
			[276.089905, 1171.839722, -56.365200],
			[276.089905, 1171.839722, -54.387360],
			[275.353912, 1174.509888, -54.387360],
			[276.089905, 1166.160400, -56.365200],
			[275.353912, 1163.490112, -54.387360],
			[274.249939, 1161.320068, -54.387360],
			[274.249939, 1176.680054, -56.365200],
		];
		three.expectVerticesInArray(expectedVertices, bracketMeshVertices);
	});

	it('should generate a transformed spinner mesh', async () => {
		const plateMesh = three.find<Mesh>(gltf, 'spinners', 'Transformed', 'spinnerplate-Transformed');
		const plateMeshVertices = three.vertices(plateMesh);
		let expectedVertices = [
			[440.618469, 1159.417236, -57.644672],
			[439.299316, 1153.200562, -57.644672],
			[439.300446, 1153.200317, -8.555094],
			[440.619598, 1159.416992, -8.555094],
			[357.380402, 1170.583008, -57.644905],
			[358.699554, 1176.799683, -57.644905],
			[358.699646, 1176.799683, -8.554977],
			[357.380524, 1170.582886, -8.554977],
			[431.532776, 1154.848511, -0.614468],
			[365.148193, 1168.934692, -0.614353],
			[432.851929, 1161.065308, -0.614468],
			[366.467346, 1175.151489, -0.614353],
			[431.531647, 1154.848755, -65.585297],
			[366.467224, 1175.151489, -65.585526],
			[365.148071, 1168.934692, -65.585526],
			[432.850800, 1161.065552, -65.585297],
			[435.821259, 1160.435181, -64.980072],
			[434.502136, 1154.218506, -64.980072],
			[438.341278, 1159.900513, -63.258781],
			[437.022125, 1153.683716, -63.258781],
			[440.025085, 1159.543213, -60.682556],
			[438.706055, 1153.326416, -60.682556],
			[363.497772, 1175.781494, -64.979843],
			[362.178619, 1169.564819, -64.979843],
			[360.977753, 1176.316284, -63.258549],
			[359.658630, 1170.099487, -63.258549],
			[359.293945, 1176.673584, -60.682438],
			[357.974823, 1170.456787, -60.682438],
			[435.821381, 1160.435181, -1.220150],
			[434.502228, 1154.218506, -1.220150],
			[438.341370, 1159.900513, -2.941448],
			[437.022247, 1153.683716, -2.941448],
			[440.025177, 1159.543213, -5.517559],
			[438.706055, 1153.326416, -5.517559],
			[363.497864, 1175.781494, -1.219921],
			[366.467346, 1175.151489, -0.614353],
			[362.178741, 1169.564819, -1.219921],
			[365.148193, 1168.934692, -0.614353],
			[360.977875, 1176.316284, -2.941332],
			[359.658722, 1170.099487, -2.941332],
			[359.293945, 1176.673584, -5.517443],
			[357.974915, 1170.456787, -5.517443],
			[435.821259, 1160.435181, -64.980072],
			[399.659546, 1168.108276, -33.099998],
			[432.850800, 1161.065552, -65.585297],
			[438.341278, 1159.900513, -63.258781],
			[440.025085, 1159.543213, -60.682556],
			[440.618469, 1159.417236, -57.644672],
			[366.467224, 1175.151489, -65.585526],
			[363.497772, 1175.781494, -64.979843],
			[360.977753, 1176.316284, -63.258549],
			[359.293945, 1176.673584, -60.682438],
			[358.699554, 1176.799683, -57.644905],
			[358.699646, 1176.799683, -8.554977],
			[359.293945, 1176.673584, -5.517443],
			[360.977875, 1176.316284, -2.941332],
			[363.497864, 1175.781494, -1.219921],
			[366.467346, 1175.151489, -0.614353],
			[432.851929, 1161.065308, -0.614468],
			[435.821381, 1160.435181, -1.220150],
			[438.341370, 1159.900513, -2.941448],
			[440.025177, 1159.543213, -5.517559],
			[440.619598, 1159.416992, -8.555094],
			[431.531647, 1154.848755, -65.585297],
			[398.340454, 1161.891724, -33.099998],
			[434.502136, 1154.218506, -64.980072],
			[437.022125, 1153.683716, -63.258781],
			[438.706055, 1153.326416, -60.682556],
			[439.299316, 1153.200562, -57.644672],
			[365.148071, 1168.934692, -65.585526],
			[362.178619, 1169.564819, -64.979843],
			[359.658630, 1170.099487, -63.258549],
			[357.974823, 1170.456787, -60.682438],
			[357.380402, 1170.583008, -57.644905],
			[357.380524, 1170.582886, -8.554977],
			[357.974915, 1170.456787, -5.517443],
			[359.658722, 1170.099487, -2.941332],
			[362.178741, 1169.564819, -1.219921],
			[365.148193, 1168.934692, -0.614353],
			[431.532776, 1154.848511, -0.614468],
			[434.502228, 1154.218506, -1.220150],
			[437.022247, 1153.683716, -2.941448],
			[438.706055, 1153.326416, -5.517559],
			[439.300446, 1153.200317, -8.555094],
			[452.881134, 1154.618530, -25.466257],
			[345.332367, 1176.387695, -25.892105],
			[452.667633, 1153.612305, -25.892336],
			[345.545898, 1177.393921, -25.466026],
			[345.634369, 1177.810913, -24.437382],
			[452.969574, 1155.035278, -24.437614],
			[452.881134, 1154.618530, -23.408972],
			[345.545898, 1177.393921, -23.408741],
			[345.332367, 1176.387695, -22.982660],
			[452.667633, 1153.612305, -22.982891],
			[452.454102, 1152.606079, -23.408972],
			[345.332367, 1176.387695, -22.982660],
			[452.667633, 1153.612305, -22.982891],
			[345.118866, 1175.381470, -23.408741],
			[345.030426, 1174.964722, -24.437382],
			[452.365631, 1152.189087, -24.437614],
			[452.454102, 1152.606079, -25.466257],
			[345.118866, 1175.381470, -25.466026],
			[344.220154, 1176.623657, -26.187901],
			[344.139008, 1177.692505, -25.886677],
			[343.515869, 1178.260254, -25.159258],
			[342.715851, 1177.994507, -24.431839],
			[342.207672, 1177.050781, -24.130615],
			[342.207672, 1177.050781, -24.130615],
			[342.288818, 1175.981934, -24.431839],
			[342.911957, 1175.414185, -25.159258],
			[343.711975, 1175.680054, -25.886677],
			[343.930908, 1176.685059, -27.324883],
			[343.727509, 1177.779785, -27.324883],
			[342.809723, 1178.410156, -27.324883],
			[341.715027, 1178.206787, -27.324883],
			[341.084717, 1177.289063, -27.324883],
			[341.084717, 1177.289063, -27.324883],
			[341.288025, 1176.194336, -27.324883],
			[342.205811, 1175.564087, -27.324883],
			[343.300476, 1175.767334, -27.324883],
			[454.288025, 1154.319946, -25.886908],
			[453.779846, 1153.376343, -26.188131],
			[455.088043, 1154.585815, -25.159489],
			[455.711182, 1154.018066, -24.432070],
			[455.792419, 1152.949219, -24.130846],
			[455.284149, 1152.005493, -24.432070],
			[455.792419, 1152.949219, -24.130846],
			[454.484131, 1151.739746, -25.159489],
			[453.860992, 1152.307495, -25.886908],
			[454.699524, 1154.232666, -27.325115],
			[454.069214, 1153.314941, -27.325115],
			[455.794189, 1154.435913, -27.325115],
			[456.711975, 1153.805664, -27.325115],
			[456.915375, 1152.710938, -27.325115],
			[456.284973, 1151.793213, -27.325115],
			[456.915375, 1152.710938, -27.325115],
			[455.190277, 1151.589844, -27.325115],
			[454.272491, 1152.220215, -27.325115],
			[343.930786, 1176.685059, -30.212383],
			[343.727509, 1177.779785, -30.212383],
			[342.809723, 1178.410156, -30.212383],
			[341.715027, 1178.206787, -30.212383],
			[341.084717, 1177.289063, -30.212383],
			[341.084717, 1177.289063, -30.212383],
			[341.288025, 1176.194336, -30.212383],
			[342.205811, 1175.564087, -30.212383],
			[343.300476, 1175.767334, -30.212383],
			[454.699524, 1154.232666, -30.212614],
			[454.069214, 1153.314941, -30.212614],
			[455.794189, 1154.435913, -30.212614],
			[456.711975, 1153.805664, -30.212614],
			[456.915283, 1152.710938, -30.212614],
			[456.284973, 1151.793213, -30.212614],
			[456.915283, 1152.710938, -30.212614],
			[455.190277, 1151.589844, -30.212614],
			[454.272491, 1152.220215, -30.212614],
			[342.807861, 1176.923340, -33.406651],
			[342.726715, 1177.992188, -33.105427],
			[342.103577, 1178.559937, -32.378010],
			[341.303558, 1178.294189, -31.650589],
			[340.795380, 1177.350464, -31.349365],
			[340.795380, 1177.350464, -31.349365],
			[340.876526, 1176.281616, -31.650589],
			[341.499664, 1175.713867, -32.378010],
			[342.299683, 1175.979736, -33.105427],
			[339.683167, 1177.586426, -34.554604],
			[339.896667, 1178.592651, -34.128525],
			[339.985107, 1179.009521, -33.099884],
			[339.896667, 1178.592651, -32.071239],
			[339.683167, 1177.586426, -31.645161],
			[339.683167, 1177.586426, -31.645161],
			[339.469635, 1176.580200, -32.071239],
			[339.381195, 1176.163330, -33.099884],
			[339.469635, 1176.580200, -34.128525],
			[455.700317, 1154.020264, -33.105659],
			[455.192139, 1153.076660, -33.406883],
			[456.500336, 1154.286133, -32.378239],
			[457.123474, 1153.718384, -31.650820],
			[457.204620, 1152.649536, -31.349596],
			[456.696442, 1151.705811, -31.650820],
			[457.204620, 1152.649536, -31.349596],
			[455.896423, 1151.440063, -32.378239],
			[455.273285, 1152.007813, -33.105659],
			[458.530365, 1153.419800, -34.128757],
			[458.316833, 1152.413574, -34.554836],
			[458.618805, 1153.836670, -33.100113],
			[458.530365, 1153.419800, -32.071472],
			[458.316833, 1152.413574, -31.645391],
			[458.103333, 1151.407349, -32.071472],
			[458.316833, 1152.413574, -31.645391],
			[458.014893, 1150.990479, -33.100113],
			[458.103333, 1151.407349, -34.128757],
			[478.131256, 1149.260742, -34.128872],
			[477.917725, 1148.254395, -34.554951],
			[478.219696, 1149.677612, -33.100113],
			[478.131256, 1149.260742, -32.071472],
			[477.917725, 1148.254395, -31.645391],
			[477.704224, 1147.248169, -32.071472],
			[477.917725, 1148.254395, -31.645391],
			[477.615753, 1146.831421, -33.100113],
			[477.704224, 1147.248169, -34.128872],
			[319.861755, 1181.792358, -34.554604],
			[320.075256, 1182.798584, -34.128525],
			[320.163696, 1183.215454, -33.099884],
			[320.075256, 1182.798584, -32.071125],
			[319.861755, 1181.792358, -31.645044],
			[319.861755, 1181.792358, -31.645044],
			[319.648193, 1180.786011, -32.071125],
			[319.559753, 1180.369263, -33.099884],
			[319.648193, 1180.786011, -34.128525],
			[319.861755, 1181.792358, -33.099884],
			[319.861755, 1181.792358, -34.554604],
			[320.075256, 1182.798584, -34.128525],
			[320.163696, 1183.215454, -33.099884],
			[320.075256, 1182.798584, -32.071125],
			[319.861755, 1181.792358, -31.645044],
			[319.648193, 1180.786011, -32.071125],
			[319.559753, 1180.369263, -33.099884],
			[319.648193, 1180.786011, -34.128525],
			[477.917725, 1148.254395, -33.100113],
			[478.131256, 1149.260742, -34.128872],
			[477.917725, 1148.254395, -34.554951],
			[478.219696, 1149.677612, -33.100113],
			[478.131256, 1149.260742, -32.071472],
			[477.917725, 1148.254395, -31.645391],
			[477.704224, 1147.248169, -32.071472],
			[477.615753, 1146.831421, -33.100113],
			[477.704224, 1147.248169, -34.128872],
		];
		three.expectVerticesInArray(expectedVertices, plateMeshVertices);

		const bracketMesh = three.find<Mesh>(gltf, 'spinners', 'Transformed', 'spinnerbracket-Transformed');
		const bracketMeshVertices = three.vertices(bracketMesh);
		expectedVertices = [
			[456.819733, 1153.730835, -88.099716],
			[341.586212, 1178.182373, -88.099594],
			[456.413788, 1151.817627, -88.099716],
			[341.180267, 1176.269165, -88.099594],
			[341.586212, 1178.182373, -88.099594],
			[336.988525, 1182.110840, -87.720528],
			[335.383392, 1174.546265, -87.720528],
			[341.180267, 1176.269165, -88.099594],
			[462.616608, 1155.453735, -87.720642],
			[336.988525, 1182.110840, -87.720528],
			[456.819733, 1153.730835, -88.099716],
			[341.586212, 1178.182373, -88.099594],
			[461.011475, 1147.889160, -87.720642],
			[456.413788, 1151.817627, -88.099716],
			[341.180267, 1176.269165, -88.099594],
			[335.383392, 1174.546265, -87.720528],
			[333.290222, 1190.277954, -87.098328],
			[328.687134, 1168.584961, -87.098328],
			[469.312866, 1161.415039, -87.098328],
			[333.290222, 1190.277954, -87.098328],
			[464.709778, 1139.722046, -87.098328],
			[328.687134, 1168.584961, -87.098328],
			[326.046143, 1169.145386, -87.098328],
			[330.649231, 1190.838379, -87.098328],
			[328.687134, 1168.584961, -87.098328],
			[326.046143, 1169.145386, -87.098328],
			[327.387817, 1168.860596, -84.242821],
			[331.990906, 1190.553589, -84.242821],
			[330.649231, 1190.838379, -87.098328],
			[333.290222, 1190.277954, -87.098328],
			[466.009094, 1139.446411, -84.242935],
			[464.709778, 1139.722046, -87.098328],
			[470.612183, 1161.139404, -84.242935],
			[469.312866, 1161.415039, -87.098328],
			[331.990906, 1190.553589, -84.242821],
			[470.612183, 1161.139404, -84.242935],
			[466.009094, 1139.446411, -84.242935],
			[327.387817, 1168.860596, -84.242821],
			[323.461975, 1169.693726, -84.242821],
			[328.065033, 1191.386719, -84.242821],
			[326.046143, 1169.145386, -82.863289],
			[323.461975, 1169.693726, -84.242821],
			[328.065033, 1191.386719, -84.242821],
			[330.649231, 1190.838379, -82.863289],
			[330.649231, 1190.838379, -82.863289],
			[326.046143, 1169.145386, -82.863289],
			[323.461975, 1169.693726, -29.231903],
			[328.065033, 1191.386719, -29.231903],
			[326.046143, 1169.145386, -27.852140],
			[323.461975, 1169.693726, -29.231903],
			[328.065033, 1191.386719, -29.231903],
			[330.649231, 1190.838379, -27.852140],
			[330.649231, 1190.838379, -27.852140],
			[326.046143, 1169.145386, -27.852140],
			[323.461975, 1169.693726, -24.996634],
			[328.065033, 1191.386719, -24.996634],
			[322.070343, 1169.989014, -27.852140],
			[323.461975, 1169.693726, -24.996634],
			[328.065033, 1191.386719, -24.996634],
			[326.673401, 1191.682007, -27.852140],
			[326.673401, 1191.682007, -27.852140],
			[322.070343, 1169.989014, -27.852140],
			[295.025665, 1198.397217, -24.996634],
			[292.816132, 1195.663330, -24.996634],
			[289.735687, 1188.184814, -24.996634],
			[290.422577, 1176.704224, -24.996634],
			[290.422577, 1176.704224, -27.852140],
			[295.025665, 1198.397217, -27.852140],
			[295.025665, 1198.397217, -24.996634],
			[290.422577, 1176.704224, -27.852140],
			[289.513733, 1180.099976, -27.852140],
			[289.735687, 1188.184814, -27.852140],
			[461.011475, 1147.889160, -87.720642],
			[462.616608, 1155.453735, -87.720642],
			[456.819733, 1153.730835, -88.099716],
			[456.413788, 1151.817627, -88.099716],
			[464.709778, 1139.722046, -87.098328],
			[469.312866, 1161.415039, -87.098328],
			[290.976471, 1192.112671, -27.852140],
			[289.274506, 1184.091797, -24.996634],
			[289.513733, 1180.099976, -27.852140],
			[289.274506, 1184.091797, -27.852140],
			[289.513733, 1180.099976, -24.996634],
			[289.735687, 1188.184814, -27.852140],
			[289.274506, 1184.091797, -24.996634],
			[292.816132, 1195.663330, -27.852140],
			[289.735687, 1188.184814, -24.996634],
			[290.976471, 1192.112671, -24.996634],
			[292.816132, 1195.663330, -27.852140],
			[290.976471, 1192.112671, -27.852140],
			[290.976471, 1192.112671, -24.996634],
			[292.816132, 1195.663330, -24.996634],
			[289.274506, 1184.091797, -27.852140],
			[289.513733, 1180.099976, -24.996634],
			[290.422577, 1176.704224, -24.996634],
			[295.025665, 1198.397217, -27.852140],
			[467.350769, 1139.161621, -87.098328],
			[471.953857, 1160.854614, -87.098328],
			[467.350769, 1139.161621, -87.098328],
			[471.953857, 1160.854614, -87.098328],
			[469.934967, 1138.613281, -84.242935],
			[474.538025, 1160.306274, -84.242935],
			[469.934967, 1138.613281, -84.242935],
			[467.350769, 1139.161621, -82.863403],
			[474.538025, 1160.306274, -84.242935],
			[471.953857, 1160.854614, -82.863403],
			[467.350769, 1139.161621, -82.863403],
			[471.953857, 1160.854614, -82.863403],
			[469.934967, 1138.613281, -29.231903],
			[474.538025, 1160.306274, -29.231903],
			[469.934967, 1138.613281, -29.231903],
			[467.350769, 1139.161621, -27.852257],
			[474.538025, 1160.306274, -29.231903],
			[471.953857, 1160.854614, -27.852257],
			[471.953857, 1160.854614, -27.852257],
			[467.350769, 1139.161621, -27.852257],
			[469.934967, 1138.613281, -24.996750],
			[474.538025, 1160.306274, -24.996750],
			[471.326599, 1138.317993, -27.852257],
			[469.934967, 1138.613281, -24.996750],
			[475.929657, 1160.010986, -27.852257],
			[474.538025, 1160.306274, -24.996750],
			[471.326599, 1138.317993, -27.852257],
			[475.929657, 1160.010986, -27.852257],
			[508.486267, 1149.900024, -24.996750],
			[507.577423, 1153.295776, -24.996750],
			[508.264313, 1141.815186, -24.996750],
			[502.974335, 1131.602783, -24.996750],
			[502.974335, 1131.602783, -27.852257],
			[507.577423, 1153.295776, -24.996750],
			[507.577423, 1153.295776, -27.852257],
			[505.183868, 1134.336670, -27.852257],
			[502.974335, 1131.602783, -27.852257],
			[508.264313, 1141.815186, -27.852257],
			[508.725494, 1145.908203, -27.852257],
			[507.023529, 1137.887329, -24.996750],
			[505.183868, 1134.336670, -24.996750],
			[507.023529, 1137.887329, -27.852257],
			[505.183868, 1134.336670, -27.852257],
			[507.023529, 1137.887329, -24.996750],
			[508.264313, 1141.815186, -27.852257],
			[508.486267, 1149.900024, -27.852257],
			[508.725494, 1145.908203, -24.996750],
			[508.264313, 1141.815186, -24.996750],
			[508.486267, 1149.900024, -27.852257],
			[508.725494, 1145.908203, -27.852257],
			[508.725494, 1145.908203, -24.996750],
			[508.486267, 1149.900024, -24.996750],
			[507.023529, 1137.887329, -27.852257],
			[505.183868, 1134.336670, -24.996750],
			[502.974335, 1131.602783, -24.996750],
			[507.577423, 1153.295776, -27.852257],
		];
		three.expectVerticesInArray(expectedVertices, bracketMeshVertices);
	});

	it('should generate generate the plate only when bracket is invisible', async () => {
		const plateMesh = three.find<Mesh>(gltf, 'spinners', 'WithoutBracket', 'spinnerplate-WithoutBracket');
		const plateMeshVertices = three.vertices(plateMesh);
		const expectedVertices = [
			[616.001465, 1175.200928, -77.000641],
			[616.001465, 1170.799072, -77.000641],
			[616.002258, 1170.799072, -42.999199],
			[616.002258, 1175.200928, -42.999199],
			[557.997742, 1170.799072, -77.000801],
			[557.997742, 1175.200928, -77.000801],
			[557.997864, 1175.200928, -42.999119],
			[557.997864, 1170.799072, -42.999119],
			[610.502258, 1170.799072, -37.499199],
			[563.497864, 1170.799072, -37.499123],
			[610.502258, 1175.200928, -37.499199],
			[563.497864, 1175.200928, -37.499123],
			[610.501465, 1170.799072, -82.500641],
			[563.497742, 1175.200928, -82.500801],
			[563.497742, 1170.799072, -82.500801],
			[610.501465, 1175.200928, -82.500641],
			[612.604736, 1175.200928, -82.081436],
			[612.604736, 1170.799072, -82.081436],
			[614.389038, 1175.200928, -80.889206],
			[614.389038, 1170.799072, -80.889206],
			[615.581299, 1175.200928, -79.104797],
			[615.581360, 1170.799072, -79.104797],
			[561.395203, 1175.200928, -82.081284],
			[561.395203, 1170.799072, -82.081284],
			[559.610901, 1175.200928, -80.889038],
			[559.610901, 1170.799072, -80.889038],
			[558.418640, 1175.200928, -79.104721],
			[558.418640, 1170.799072, -79.104721],
			[612.604797, 1175.200928, -37.918720],
			[612.604797, 1170.799072, -37.918720],
			[614.389099, 1175.200928, -39.110962],
			[614.389099, 1170.799072, -39.110962],
			[615.581360, 1175.200928, -40.895279],
			[615.581360, 1170.799072, -40.895279],
			[561.395264, 1175.200928, -37.918560],
			[563.497864, 1175.200928, -37.499123],
			[561.395264, 1170.799072, -37.918560],
			[563.497864, 1170.799072, -37.499123],
			[559.610962, 1175.200928, -39.110878],
			[559.610962, 1170.799072, -39.110878],
			[558.418640, 1175.200928, -40.895199],
			[558.418701, 1170.799072, -40.895199],
			[612.604736, 1175.200928, -82.081436],
			[587.000000, 1175.200928, -60.000000],
			[610.501465, 1175.200928, -82.500641],
			[614.389038, 1175.200928, -80.889206],
			[615.581299, 1175.200928, -79.104797],
			[616.001465, 1175.200928, -77.000641],
			[563.497742, 1175.200928, -82.500801],
			[561.395203, 1175.200928, -82.081284],
			[559.610901, 1175.200928, -80.889038],
			[558.418640, 1175.200928, -79.104721],
			[557.997742, 1175.200928, -77.000801],
			[557.997864, 1175.200928, -42.999119],
			[558.418640, 1175.200928, -40.895199],
			[559.610962, 1175.200928, -39.110878],
			[561.395264, 1175.200928, -37.918560],
			[563.497864, 1175.200928, -37.499123],
			[610.502258, 1175.200928, -37.499199],
			[612.604797, 1175.200928, -37.918720],
			[614.389099, 1175.200928, -39.110962],
			[615.581360, 1175.200928, -40.895279],
			[616.002258, 1175.200928, -42.999199],
			[610.501465, 1170.799072, -82.500641],
			[587.000000, 1170.799072, -60.000000],
			[612.604736, 1170.799072, -82.081436],
			[614.389038, 1170.799072, -80.889206],
			[615.581360, 1170.799072, -79.104797],
			[616.001465, 1170.799072, -77.000641],
			[563.497742, 1170.799072, -82.500801],
			[561.395203, 1170.799072, -82.081284],
			[559.610901, 1170.799072, -80.889038],
			[558.418640, 1170.799072, -79.104721],
			[557.997742, 1170.799072, -77.000801],
			[557.997864, 1170.799072, -42.999119],
			[558.418701, 1170.799072, -40.895199],
			[559.610962, 1170.799072, -39.110878],
			[561.395264, 1170.799072, -37.918560],
			[563.497864, 1170.799072, -37.499123],
			[610.502258, 1170.799072, -37.499199],
			[612.604797, 1170.799072, -37.918720],
			[614.389099, 1170.799072, -39.110962],
			[615.581360, 1170.799072, -40.895279],
			[616.002258, 1170.799072, -42.999199],
			[625.000000, 1173.712524, -54.712559],
			[549.000000, 1172.999878, -55.007519],
			[625.000000, 1173.000122, -55.007679],
			[549.000000, 1173.712402, -54.712399],
			[549.000000, 1174.007568, -53.999920],
			[625.000000, 1174.007690, -54.000080],
			[625.000000, 1173.712524, -53.287601],
			[549.000000, 1173.712402, -53.287441],
			[549.000000, 1172.999878, -52.992321],
			[625.000000, 1173.000122, -52.992481],
			[625.000000, 1172.287598, -53.287601],
			[549.000000, 1172.999878, -52.992321],
			[625.000000, 1173.000122, -52.992481],
			[549.000000, 1172.287476, -53.287441],
			[549.000000, 1171.992310, -53.999920],
			[625.000000, 1171.992432, -54.000080],
			[625.000000, 1172.287598, -54.712559],
			[549.000000, 1172.287476, -54.712399],
			[548.212463, 1172.999878, -55.212399],
			[548.003845, 1173.712402, -55.003761],
			[547.500000, 1174.007568, -54.499920],
			[546.996155, 1173.712402, -53.996078],
			[546.787537, 1172.999878, -53.787441],
			[546.787537, 1172.999878, -53.787441],
			[546.996155, 1172.287476, -53.996078],
			[547.500000, 1171.992310, -54.499920],
			[548.003845, 1172.287476, -55.003761],
			[548.007690, 1172.999878, -55.999920],
			[547.712463, 1173.712402, -55.999920],
			[547.000000, 1174.007568, -55.999920],
			[546.287537, 1173.712402, -55.999920],
			[545.992432, 1172.999878, -55.999920],
			[545.992432, 1172.999878, -55.999920],
			[546.287537, 1172.287476, -55.999920],
			[547.000000, 1171.992310, -55.999920],
			[547.712463, 1172.287476, -55.999920],
			[625.996155, 1173.712524, -55.003922],
			[625.787537, 1173.000122, -55.212559],
			[626.500000, 1174.007690, -54.500080],
			[627.003845, 1173.712524, -53.996239],
			[627.212585, 1173.000122, -53.787598],
			[627.003845, 1172.287598, -53.996239],
			[627.212585, 1173.000122, -53.787598],
			[626.500000, 1171.992432, -54.500080],
			[625.996155, 1172.287598, -55.003922],
			[626.287537, 1173.712524, -56.000080],
			[625.992432, 1173.000122, -56.000080],
			[627.000000, 1174.007690, -56.000080],
			[627.712463, 1173.712524, -56.000080],
			[628.007690, 1173.000122, -56.000080],
			[627.712463, 1172.287598, -56.000080],
			[628.007690, 1173.000122, -56.000080],
			[627.000000, 1171.992432, -56.000080],
			[626.287537, 1172.287598, -56.000080],
			[548.007568, 1172.999878, -57.999920],
			[547.712463, 1173.712402, -57.999920],
			[547.000000, 1174.007568, -57.999920],
			[546.287537, 1173.712402, -57.999920],
			[545.992432, 1172.999878, -57.999920],
			[545.992432, 1172.999878, -57.999920],
			[546.287537, 1172.287476, -57.999920],
			[547.000000, 1171.992310, -57.999920],
			[547.712463, 1172.287476, -57.999920],
			[626.287537, 1173.712524, -58.000080],
			[625.992432, 1173.000122, -58.000080],
			[627.000000, 1174.007690, -58.000080],
			[627.712463, 1173.712524, -58.000080],
			[628.007568, 1173.000122, -58.000080],
			[627.712463, 1172.287598, -58.000080],
			[628.007568, 1173.000122, -58.000080],
			[627.000000, 1171.992432, -58.000080],
			[626.287537, 1172.287598, -58.000080],
			[547.212463, 1172.999878, -60.212399],
			[547.003845, 1173.712402, -60.003761],
			[546.500000, 1174.007568, -59.499920],
			[545.996155, 1173.712402, -58.996078],
			[545.787537, 1172.999878, -58.787441],
			[545.787537, 1172.999878, -58.787441],
			[545.996155, 1172.287476, -58.996078],
			[546.500000, 1171.992310, -59.499920],
			[547.003845, 1172.287476, -60.003761],
			[545.000000, 1172.999878, -61.007519],
			[545.000000, 1173.712402, -60.712399],
			[545.000000, 1174.007568, -59.999920],
			[545.000000, 1173.712402, -59.287441],
			[545.000000, 1172.999878, -58.992321],
			[545.000000, 1172.999878, -58.992321],
			[545.000000, 1172.287476, -59.287441],
			[545.000000, 1171.992310, -59.999920],
			[545.000000, 1172.287476, -60.712399],
			[626.996155, 1173.712524, -60.003922],
			[626.787537, 1173.000122, -60.212559],
			[627.500000, 1174.007690, -59.500080],
			[628.003845, 1173.712524, -58.996239],
			[628.212463, 1173.000122, -58.787601],
			[628.003845, 1172.287598, -58.996239],
			[628.212463, 1173.000122, -58.787601],
			[627.500000, 1171.992432, -59.500080],
			[626.996155, 1172.287598, -60.003922],
			[629.000000, 1173.712524, -60.712559],
			[629.000000, 1173.000122, -61.007679],
			[629.000000, 1174.007690, -60.000080],
			[629.000000, 1173.712524, -59.287601],
			[629.000000, 1173.000122, -58.992481],
			[629.000000, 1172.287598, -59.287601],
			[629.000000, 1173.000122, -58.992481],
			[629.000000, 1171.992432, -60.000080],
			[629.000000, 1172.287598, -60.712559],
			[642.878662, 1173.712646, -60.712639],
			[642.878662, 1173.000122, -61.007759],
			[642.878662, 1174.007813, -60.000080],
			[642.878662, 1173.712646, -59.287601],
			[642.878662, 1173.000122, -58.992481],
			[642.878662, 1172.287598, -59.287601],
			[642.878662, 1173.000122, -58.992481],
			[642.878662, 1171.992432, -60.000080],
			[642.878662, 1172.287598, -60.712639],
			[530.965210, 1172.999878, -61.007519],
			[530.965210, 1173.712402, -60.712399],
			[530.965210, 1174.007568, -59.999920],
			[530.965210, 1173.712402, -59.287361],
			[530.965210, 1172.999878, -58.992241],
			[530.965210, 1172.999878, -58.992241],
			[530.965210, 1172.287354, -59.287361],
			[530.965210, 1171.992188, -59.999920],
			[530.965210, 1172.287354, -60.712399],
			[530.965210, 1172.999878, -59.999920],
			[530.965210, 1172.999878, -61.007519],
			[530.965210, 1173.712402, -60.712399],
			[530.965210, 1174.007568, -59.999920],
			[530.965210, 1173.712402, -59.287361],
			[530.965210, 1172.999878, -58.992241],
			[530.965210, 1172.287354, -59.287361],
			[530.965210, 1171.992188, -59.999920],
			[530.965210, 1172.287354, -60.712399],
			[642.878662, 1173.000122, -60.000080],
			[642.878662, 1173.712646, -60.712639],
			[642.878662, 1173.000122, -61.007759],
			[642.878662, 1174.007813, -60.000080],
			[642.878662, 1173.712646, -59.287601],
			[642.878662, 1173.000122, -58.992481],
			[642.878662, 1172.287598, -59.287601],
			[642.878662, 1171.992432, -60.000080],
			[642.878662, 1172.287598, -60.712639],
		];
		three.expectVerticesInArray(expectedVertices, plateMeshVertices);
		three.expectNoObject(gltf, 'spinners', 'WithoutBracket', 'spinnerbracket-WithoutBracket');
	});

	it('should generate a spinner mesh on a surface', async () => {
		const plateMesh = three.find<Mesh>(gltf, 'spinners', 'Surface', 'spinnerplate-Surface');
		const plateMeshVertices = three.vertices(plateMesh);
		let expectedVertices = [
			[536.001465, 961.200989, -127.000641],
			[536.001465, 956.799133, -127.000641],
			[536.002258, 956.799133, -92.999199],
			[536.002258, 961.200989, -92.999199],
			[477.997772, 956.799011, -127.000801],
			[477.997772, 961.200867, -127.000801],
			[477.997833, 961.200867, -92.999115],
			[477.997833, 956.799011, -92.999115],
			[530.502258, 956.799133, -87.499199],
			[483.497833, 956.799011, -87.499123],
			[530.502258, 961.200989, -87.499199],
			[483.497833, 961.200867, -87.499123],
			[530.501465, 956.799133, -132.500641],
			[483.497772, 961.200867, -132.500793],
			[483.497772, 956.799011, -132.500793],
			[530.501465, 961.200989, -132.500641],
			[532.604736, 961.200989, -132.081436],
			[532.604736, 956.799133, -132.081436],
			[534.389038, 961.200989, -130.889206],
			[534.389038, 956.799133, -130.889206],
			[535.581299, 961.200989, -129.104797],
			[535.581360, 956.799133, -129.104797],
			[481.395203, 961.200867, -132.081284],
			[481.395203, 956.799011, -132.081284],
			[479.610870, 961.200867, -130.889038],
			[479.610870, 956.799011, -130.889038],
			[478.418640, 961.200867, -129.104721],
			[478.418640, 956.799011, -129.104721],
			[532.604797, 961.200989, -87.918716],
			[532.604797, 956.799133, -87.918716],
			[534.389099, 961.200989, -89.110962],
			[534.389099, 956.799133, -89.110962],
			[535.581360, 961.200989, -90.895279],
			[535.581360, 956.799133, -90.895279],
			[481.395264, 961.200867, -87.918564],
			[483.497833, 961.200867, -87.499123],
			[481.395264, 956.799011, -87.918564],
			[483.497833, 956.799011, -87.499123],
			[479.610962, 961.200867, -89.110878],
			[479.610962, 956.799011, -89.110878],
			[478.418640, 961.200867, -90.895203],
			[478.418732, 956.799011, -90.895203],
			[532.604736, 961.200989, -132.081436],
			[507.000000, 961.200867, -110.000000],
			[530.501465, 961.200989, -132.500641],
			[534.389038, 961.200989, -130.889206],
			[535.581299, 961.200989, -129.104797],
			[536.001465, 961.200989, -127.000641],
			[483.497772, 961.200867, -132.500793],
			[481.395203, 961.200867, -132.081284],
			[479.610870, 961.200867, -130.889038],
			[478.418640, 961.200867, -129.104721],
			[477.997772, 961.200867, -127.000801],
			[477.997833, 961.200867, -92.999115],
			[478.418640, 961.200867, -90.895203],
			[479.610962, 961.200867, -89.110878],
			[481.395264, 961.200867, -87.918564],
			[483.497833, 961.200867, -87.499123],
			[530.502258, 961.200989, -87.499199],
			[532.604797, 961.200989, -87.918716],
			[534.389099, 961.200989, -89.110962],
			[535.581360, 961.200989, -90.895279],
			[536.002258, 961.200989, -92.999199],
			[530.501465, 956.799133, -132.500641],
			[507.000000, 956.799133, -110.000000],
			[532.604736, 956.799133, -132.081436],
			[534.389038, 956.799133, -130.889206],
			[535.581360, 956.799133, -129.104797],
			[536.001465, 956.799133, -127.000641],
			[483.497772, 956.799011, -132.500793],
			[481.395203, 956.799011, -132.081284],
			[479.610870, 956.799011, -130.889038],
			[478.418640, 956.799011, -129.104721],
			[477.997772, 956.799011, -127.000801],
			[477.997833, 956.799011, -92.999115],
			[478.418732, 956.799011, -90.895203],
			[479.610962, 956.799011, -89.110878],
			[481.395264, 956.799011, -87.918564],
			[483.497833, 956.799011, -87.499123],
			[530.502258, 956.799133, -87.499199],
			[532.604797, 956.799133, -87.918716],
			[534.389099, 956.799133, -89.110962],
			[535.581360, 956.799133, -90.895279],
			[536.002258, 956.799133, -92.999199],
			[545.000000, 959.712585, -104.712563],
			[469.000000, 958.999939, -105.007523],
			[545.000000, 959.000061, -105.007683],
			[469.000000, 959.712402, -104.712402],
			[469.000000, 960.007629, -103.999924],
			[545.000000, 960.007690, -104.000076],
			[545.000000, 959.712585, -103.287598],
			[469.000000, 959.712402, -103.287437],
			[469.000000, 958.999939, -102.992317],
			[545.000000, 959.000061, -102.992477],
			[545.000000, 958.287598, -103.287598],
			[469.000000, 958.999939, -102.992317],
			[545.000000, 959.000061, -102.992477],
			[469.000000, 958.287415, -103.287437],
			[469.000000, 957.992310, -103.999924],
			[545.000000, 957.992371, -104.000076],
			[545.000000, 958.287598, -104.712563],
			[469.000000, 958.287415, -104.712402],
			[468.212463, 958.999939, -105.212402],
			[468.003845, 959.712402, -105.003761],
			[467.500000, 960.007507, -104.499924],
			[466.996155, 959.712402, -103.996078],
			[466.787537, 958.999939, -103.787437],
			[466.787537, 958.999939, -103.787437],
			[466.996155, 958.287415, -103.996078],
			[467.500000, 957.992310, -104.499924],
			[468.003845, 958.287415, -105.003761],
			[468.007690, 958.999939, -105.999924],
			[467.712463, 959.712402, -105.999924],
			[467.000000, 960.007507, -105.999924],
			[466.287537, 959.712402, -105.999924],
			[465.992401, 958.999939, -105.999924],
			[465.992401, 958.999939, -105.999924],
			[466.287537, 958.287415, -105.999924],
			[467.000000, 957.992310, -105.999924],
			[467.712463, 958.287415, -105.999924],
			[545.996155, 959.712585, -105.003922],
			[545.787537, 959.000061, -105.212563],
			[546.500000, 960.007690, -104.500076],
			[547.003845, 959.712585, -103.996239],
			[547.212585, 959.000061, -103.787598],
			[547.003845, 958.287598, -103.996239],
			[547.212585, 959.000061, -103.787598],
			[546.500000, 957.992493, -104.500076],
			[545.996155, 958.287598, -105.003922],
			[546.287537, 959.712585, -106.000076],
			[545.992432, 959.000061, -106.000076],
			[547.000000, 960.007690, -106.000076],
			[547.712463, 959.712585, -106.000076],
			[548.007690, 959.000061, -106.000076],
			[547.712463, 958.287598, -106.000076],
			[548.007690, 959.000061, -106.000076],
			[547.000000, 957.992493, -106.000076],
			[546.287537, 958.287598, -106.000076],
			[468.007599, 958.999939, -107.999924],
			[467.712463, 959.712402, -107.999924],
			[467.000000, 960.007507, -107.999924],
			[466.287537, 959.712402, -107.999924],
			[465.992401, 958.999939, -107.999924],
			[465.992401, 958.999939, -107.999924],
			[466.287537, 958.287415, -107.999924],
			[467.000000, 957.992310, -107.999924],
			[467.712463, 958.287415, -107.999924],
			[546.287537, 959.712585, -108.000076],
			[545.992432, 959.000061, -108.000076],
			[547.000000, 960.007690, -108.000076],
			[547.712463, 959.712585, -108.000076],
			[548.007568, 959.000061, -108.000076],
			[547.712463, 958.287598, -108.000076],
			[548.007568, 959.000061, -108.000076],
			[547.000000, 957.992493, -108.000076],
			[546.287537, 958.287598, -108.000076],
			[467.212494, 958.999939, -110.212402],
			[467.003845, 959.712402, -110.003761],
			[466.500000, 960.007507, -109.499924],
			[465.996155, 959.712402, -108.996078],
			[465.787537, 958.999939, -108.787437],
			[465.787537, 958.999939, -108.787437],
			[465.996155, 958.287415, -108.996078],
			[466.500000, 957.992310, -109.499924],
			[467.003845, 958.287415, -110.003761],
			[465.000000, 958.999939, -111.007523],
			[465.000000, 959.712402, -110.712402],
			[465.000000, 960.007507, -109.999924],
			[465.000000, 959.712402, -109.287437],
			[465.000000, 958.999939, -108.992317],
			[465.000000, 958.999939, -108.992317],
			[465.000000, 958.287415, -109.287437],
			[465.000000, 957.992310, -109.999924],
			[465.000000, 958.287415, -110.712402],
			[546.996155, 959.712585, -110.003922],
			[546.787537, 959.000061, -110.212563],
			[547.500000, 960.007690, -109.500076],
			[548.003845, 959.712585, -108.996239],
			[548.212463, 959.000061, -108.787598],
			[548.003845, 958.287598, -108.996239],
			[548.212463, 959.000061, -108.787598],
			[547.500000, 957.992493, -109.500076],
			[546.996155, 958.287598, -110.003922],
			[549.000000, 959.712585, -110.712563],
			[549.000000, 959.000061, -111.007683],
			[549.000000, 960.007690, -110.000076],
			[549.000000, 959.712585, -109.287598],
			[549.000000, 959.000061, -108.992477],
			[549.000000, 958.287598, -109.287598],
			[549.000000, 959.000061, -108.992477],
			[549.000000, 957.992493, -110.000076],
			[549.000000, 958.287598, -110.712563],
			[562.878662, 959.712646, -110.712639],
			[562.878662, 959.000061, -111.007759],
			[562.878662, 960.007751, -110.000076],
			[562.878662, 959.712646, -109.287598],
			[562.878662, 959.000061, -108.992477],
			[562.878662, 958.287598, -109.287598],
			[562.878662, 959.000061, -108.992477],
			[562.878662, 957.992493, -110.000076],
			[562.878662, 958.287598, -110.712639],
			[450.965210, 958.999939, -111.007523],
			[450.965210, 959.712402, -110.712402],
			[450.965210, 960.007507, -109.999924],
			[450.965210, 959.712402, -109.287361],
			[450.965210, 958.999939, -108.992241],
			[450.965210, 958.999939, -108.992241],
			[450.965210, 958.287354, -109.287361],
			[450.965210, 957.992249, -109.999924],
			[450.965210, 958.287354, -110.712402],
			[450.965210, 958.999939, -109.999924],
			[450.965210, 958.999939, -111.007523],
			[450.965210, 959.712402, -110.712402],
			[450.965210, 960.007507, -109.999924],
			[450.965210, 959.712402, -109.287361],
			[450.965210, 958.999939, -108.992241],
			[450.965210, 958.287354, -109.287361],
			[450.965210, 957.992249, -109.999924],
			[450.965210, 958.287354, -110.712402],
			[562.878662, 959.000061, -110.000076],
			[562.878662, 959.712646, -110.712639],
			[562.878662, 959.000061, -111.007759],
			[562.878662, 960.007751, -110.000076],
			[562.878662, 959.712646, -109.287598],
			[562.878662, 959.000061, -108.992477],
			[562.878662, 958.287598, -109.287598],
			[562.878662, 957.992493, -110.000076],
			[562.878662, 958.287598, -110.712639],
		];
		three.expectVerticesInArray(expectedVertices, plateMeshVertices);

		const bracketMesh = three.find<Mesh>(gltf, 'spinners', 'Surface', 'spinnerbracket-Surface');
		const bracketMeshVertices = three.vertices(bracketMesh);
		expectedVertices = [
			[547.796265, 959.677368, -148.095032],
			[466.203766, 959.677307, -148.094955],
			[547.796265, 958.322693, -148.095032],
			[466.203766, 958.322632, -148.094955],
			[466.203766, 959.677307, -148.094955],
			[462.523743, 961.678101, -147.832397],
			[462.523743, 956.321838, -147.832397],
			[466.203766, 958.322632, -148.094955],
			[551.476257, 961.678162, -147.832489],
			[462.523743, 961.678101, -147.832397],
			[547.796265, 959.677368, -148.095032],
			[466.203766, 959.677307, -148.094955],
			[551.476257, 956.321899, -147.832489],
			[547.796265, 958.322693, -148.095032],
			[466.203766, 958.322632, -148.094955],
			[462.523743, 956.321838, -147.832397],
			[458.843750, 966.679993, -147.401443],
			[458.843750, 951.320007, -147.401443],
			[555.156250, 966.679993, -147.401443],
			[458.843750, 966.679993, -147.401443],
			[555.156250, 951.320007, -147.401443],
			[458.843750, 951.320007, -147.401443],
			[456.973755, 951.320007, -147.401443],
			[456.973755, 966.679993, -147.401443],
			[458.843750, 951.320007, -147.401443],
			[456.973755, 951.320007, -147.401443],
			[457.923767, 951.320007, -145.423599],
			[457.923767, 966.679993, -145.423599],
			[456.973755, 966.679993, -147.401443],
			[458.843750, 966.679993, -147.401443],
			[556.076233, 951.320007, -145.423676],
			[555.156250, 951.320007, -147.401443],
			[556.076233, 966.679993, -145.423676],
			[555.156250, 966.679993, -147.401443],
			[457.923767, 966.679993, -145.423599],
			[556.076233, 966.679993, -145.423676],
			[556.076233, 951.320007, -145.423676],
			[457.923767, 951.320007, -145.423599],
			[455.144012, 951.320007, -145.423599],
			[455.144012, 966.679993, -145.423599],
			[456.973755, 951.320007, -144.468079],
			[455.144012, 951.320007, -145.423599],
			[455.144012, 966.679993, -145.423599],
			[456.973755, 966.679993, -144.468079],
			[456.973755, 966.679993, -144.468079],
			[456.973755, 951.320007, -144.468079],
			[455.144012, 951.320007, -107.320801],
			[455.144012, 966.679993, -107.320801],
			[456.973755, 951.320007, -106.365120],
			[455.144012, 951.320007, -107.320801],
			[455.144012, 966.679993, -107.320801],
			[456.973755, 966.679993, -106.365120],
			[456.973755, 966.679993, -106.365120],
			[456.973755, 951.320007, -106.365120],
			[455.144012, 951.320007, -104.387283],
			[455.144012, 966.679993, -104.387283],
			[454.158630, 951.320007, -106.365120],
			[455.144012, 951.320007, -104.387283],
			[455.144012, 966.679993, -104.387283],
			[454.158630, 966.679993, -106.365120],
			[454.158630, 966.679993, -106.365120],
			[454.158630, 951.320007, -106.365120],
			[431.750061, 966.679932, -104.387283],
			[430.646088, 964.509827, -104.387283],
			[429.634094, 958.999939, -104.387283],
			[431.750061, 951.319946, -104.387283],
			[431.750061, 951.319946, -106.365120],
			[431.750061, 966.679932, -106.365120],
			[431.750061, 966.679932, -104.387283],
			[431.750061, 951.319946, -106.365120],
			[430.646088, 953.490051, -106.365120],
			[429.634094, 958.999939, -106.365120],
			[551.476257, 956.321899, -147.832489],
			[551.476257, 961.678162, -147.832489],
			[547.796265, 959.677368, -148.095032],
			[547.796265, 958.322693, -148.095032],
			[555.156250, 951.320007, -147.401443],
			[555.156250, 966.679993, -147.401443],
			[429.910095, 961.839600, -106.365120],
			[429.910095, 956.160339, -104.387283],
			[430.646088, 953.490051, -106.365120],
			[429.910095, 956.160339, -106.365120],
			[430.646088, 953.490051, -104.387283],
			[429.634094, 958.999939, -106.365120],
			[429.910095, 956.160339, -104.387283],
			[430.646088, 964.509827, -106.365120],
			[429.634094, 958.999939, -104.387283],
			[429.910095, 961.839600, -104.387283],
			[430.646088, 964.509827, -106.365120],
			[429.910095, 961.839600, -106.365120],
			[429.910095, 961.839600, -104.387283],
			[430.646088, 964.509827, -104.387283],
			[429.910095, 956.160339, -106.365120],
			[430.646088, 953.490051, -104.387283],
			[431.750061, 951.319946, -104.387283],
			[431.750061, 966.679932, -106.365120],
			[557.026245, 951.320007, -147.401443],
			[557.026245, 966.679993, -147.401443],
			[557.026245, 951.320007, -147.401443],
			[557.026245, 966.679993, -147.401443],
			[558.856018, 951.320007, -145.423676],
			[558.856018, 966.679993, -145.423676],
			[558.856018, 951.320007, -145.423676],
			[557.026245, 951.320007, -144.468155],
			[558.856018, 966.679993, -145.423676],
			[557.026245, 966.679993, -144.468155],
			[557.026245, 951.320007, -144.468155],
			[557.026245, 966.679993, -144.468155],
			[558.856018, 951.320007, -107.320801],
			[558.856018, 966.679993, -107.320801],
			[558.856018, 951.320007, -107.320801],
			[557.026245, 951.320007, -106.365204],
			[558.856018, 966.679993, -107.320801],
			[557.026245, 966.679993, -106.365204],
			[557.026245, 966.679993, -106.365204],
			[557.026245, 951.320007, -106.365204],
			[558.856018, 951.320007, -104.387360],
			[558.856018, 966.679993, -104.387360],
			[559.841370, 951.320007, -106.365204],
			[558.856018, 951.320007, -104.387360],
			[559.841370, 966.679993, -106.365204],
			[558.856018, 966.679993, -104.387360],
			[559.841370, 951.320007, -106.365204],
			[559.841370, 966.679993, -106.365204],
			[583.353943, 964.509949, -104.387360],
			[582.249939, 966.680054, -104.387360],
			[584.365906, 959.000061, -104.387360],
			[582.249939, 951.320068, -104.387360],
			[582.249939, 951.320068, -106.365204],
			[582.249939, 966.680054, -104.387360],
			[582.249939, 966.680054, -106.365204],
			[583.353943, 953.490173, -106.365204],
			[582.249939, 951.320068, -106.365204],
			[584.365906, 959.000061, -106.365204],
			[584.089905, 961.839661, -106.365204],
			[584.089905, 956.160400, -104.387360],
			[583.353943, 953.490173, -104.387360],
			[584.089905, 956.160400, -106.365204],
			[583.353943, 953.490173, -106.365204],
			[584.089905, 956.160400, -104.387360],
			[584.365906, 959.000061, -106.365204],
			[583.353943, 964.509949, -106.365204],
			[584.089905, 961.839661, -104.387360],
			[584.365906, 959.000061, -104.387360],
			[583.353943, 964.509949, -106.365204],
			[584.089905, 961.839661, -106.365204],
			[584.089905, 961.839661, -104.387360],
			[583.353943, 964.509949, -104.387360],
			[584.089905, 956.160400, -106.365204],
			[583.353943, 953.490173, -104.387360],
			[582.249939, 951.320068, -104.387360],
			[582.249939, 966.680054, -106.365204],
		];
		three.expectVerticesInArray(expectedVertices, bracketMeshVertices);
	});

	it('should not generate an invisible ramp', async () => {
		three.expectNoObject(gltf, 'spinners', 'Invisible');
	});

});
